# 应用函数式编程原则

函数式编程近年来重新引起了主流编程社区的关注。函数式范式的*优势*之一是它能够很好地应对我们行业面临的多核挑战。然而，虽然这确实是一个重要的应用场景，但这并不是本文告诉你要*学习函数式编程*的原因。

掌握函数式编程范式可以极大地提高你在其他场合编写代码的质量。如果你深入理解并应用函数式范式，你的设计将表现出更高程度的*引用透明度*。

引用透明度是一个非常理想的属性：它意味着函数在给定相同输入的情况下始终产生相同的结果，无论它们何时何地被调用。也就是说，函数求值越少依赖于可变状态的副作用越好，理想情况下完全不依赖。

命令式代码中缺陷的主要原因之一归咎于可变变量。阅读本文的每个人都经历过为什么在特定情况下某个值不符合预期而调查的过程。可见性语义可以帮助减轻这些隐晦的缺陷，或者至少大大缩小它们出现的范围，但它们真正的罪魁祸首可能实际上是采用了过多可变性的设计。

在这方面，我们当然没有得到行业方面的太多指导。面向对象导论暗示了这种设计，因为它们经常展示由相对长寿对象组成的图形示例，这些对象愉快地互相调用改变状态（mutator）方法，这可能是危险的。然而，通过精心的测试驱动设计，特别是在确保["模拟角色而不是对象"](http://www.jmock.org/oopsla2004.pdf)时，可以避免不必要的可变性。

最终结果是一个设计，通常具有更好的责任分配和更多、更小的函数来处理传递给它们的参数，而不是引用可变成员变量。缺陷将更少，而且它们通常更容易调试，因为在这些设计中定位流氓值（rogue value）出现的位置比推断导致错误赋值的特定上下文要容易得多。这加起来就是更高程度的引用透明性，没有什么比学习函数式编程语言更能让这些思想深入人心了，因为这种计算模型是标准。

当然，并非在所有情况下，这种方法都是最优的。例如，在面向对象系统中，这种风格通常在域模型开发（即协作用于分解业务规则复杂度）方面比用户界面开发产生更好的结果。

掌握函数式编程范式，以便能够明智地将所学到的经验应用于其他领域。你的对象系统（其中之一）将受益于引用透明性，并且比许多人认为的更接近它们的函数式对应物。事实上，有些人甚至会断言，函数式编程和面向对象编程达到顶峰时只是彼此的映射，一种计算阴阳。

作者：[Edward Garson](http://programmer.97things.oreilly.com/wiki/index.php/Edward_Garson)
